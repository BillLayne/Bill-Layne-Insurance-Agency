let currentStep=1;const totalSteps=5;let formData={};function populateYearDropdown(){const e=document.getElementById("vehicleYear"),t=(new Date).getFullYear();for(let o=t+1;o>=t-20;o--){const t=document.createElement("option");t.value=o,t.textContent=o,e.appendChild(t)}}function setupFormValidation(){document.getElementById("autoCheckupForm").querySelectorAll("input, select").forEach(e=>{e.addEventListener("change",function(){this.validity.valid&&this.classList.remove("error")})});const e=document.getElementById("cleanRecord"),t=["hasAccidents","hasTickets","hasClaims","hasDUI"];e.addEventListener("change",function(){this.checked&&t.forEach(e=>{document.getElementById(e).checked=!1})}),t.forEach(t=>{document.getElementById(t).addEventListener("change",function(){this.checked&&(e.checked=!1)})})}function updateProgressBar(){const e=document.getElementById("progressBar"),t=currentStep/5*100;e.style.width=`${t}%`}function nextStep(){validateCurrentStep()&&(saveStepData(),currentStep++,showStep(currentStep),updateProgressBar())}function previousStep(){currentStep--,showStep(currentStep),updateProgressBar()}function showStep(e){document.querySelectorAll(".form-step").forEach(e=>e.classList.remove("active"));const t=document.querySelector(`[data-step="${e}"]`);t&&t.classList.add("active"),window.scrollTo({top:0,behavior:"smooth"})}function validateCurrentStep(){const e=document.querySelector(".form-step.active").querySelectorAll("[required]");let t=!0;return e.forEach(e=>{e.value?e.classList.remove("error"):(e.classList.add("error"),t=!1)}),t||alert("Please fill in all required fields."),t}function saveStepData(){document.querySelector(".form-step.active").querySelectorAll("input, select").forEach(e=>{"checkbox"===e.type?formData[e.name||e.id]=e.checked:formData[e.name||e.id]=e.value})}function generateReport(){validateCurrentStep()&&(saveStepData(),analyzeData(),showResults())}function analyzeData(){const e=calculateCoverageScore(),t=identifyCoverageGaps(),o=generateRecommendations(),n=identifySavings(),a=document.getElementById("scoreCircle"),r=document.getElementById("scoreNumber"),i=document.getElementById("scoreMessage");r.textContent=e,a.style.setProperty("--score-deg",e/100*360+"deg"),i.textContent=e>=80?"Excellent coverage! You're well protected.":e>=60?"Good coverage with room for improvement.":e>=40?"Your coverage needs attention.":"Critical gaps in your coverage identified.";document.getElementById("coverageGaps").innerHTML=t.map(e=>`<li>${e}</li>`).join("");document.getElementById("recommendations").innerHTML=o.map(e=>`<li>${e}</li>`).join("");document.getElementById("savingsOpportunities").innerHTML=n.map(e=>`<li>${e}</li>`).join("")}function calculateCoverageScore(){let e=100;"state-minimum"===formData.liabilityLimits?e-=30:"25/50/25"===formData.liabilityLimits?e-=20:"50/100/50"===formData.liabilityLimits?e-=10:"not-sure"===formData.liabilityLimits&&(e-=15),formData.hasUninsured||(e-=15),formData.hasCollision||"<5000"===formData.vehicleValue||(e-=10),formData.hasComprehensive||"<5000"===formData.vehicleValue||(e-=10);const t={"<50k":5e4,"50k-100k":75e3,"100k-250k":175e3,"250k-500k":375e3,"500k-1m":75e4,"1m+":15e5}[formData.netWorth]||1e5;return({"state-minimum":25e3,"25/50/25":5e4,"50/100/50":1e5,"100/300/100":3e5,"250/500/250":5e5,"500/500/500":5e5}[formData.liabilityLimits]||5e4)<.5*t&&(e-=20),formData.hasAccidents&&(e-=5),formData.hasTickets&&(e-=5),formData.hasDUI&&(e-=15),Math.max(0,Math.min(100,e))}function identifyCoverageGaps(){const e=[];"state-minimum"!==formData.liabilityLimits&&"25/50/25"!==formData.liabilityLimits||e.push("Your liability limits are dangerously low for protecting your assets"),formData.hasUninsured||e.push("No uninsured/underinsured motorist coverage leaves you vulnerable"),"<5000"===formData.vehicleValue||formData.hasCollision||e.push("No collision coverage on a valuable vehicle"),"<5000"===formData.vehicleValue||formData.hasComprehensive||e.push("No comprehensive coverage for theft, vandalism, or weather damage");const t=["250k-500k","500k-1m","1m+"].includes(formData.netWorth),o=["state-minimum","25/50/25","50/100/50"].includes(formData.liabilityLimits);return t&&o&&e.push("Your liability coverage is insufficient for your asset level - consider umbrella policy"),"rideshare"!==formData.primaryUse||e.includes("rideshare")||e.push("Standard policies may not cover rideshare activities - specialized coverage needed"),e.length>0?e:["No critical gaps identified - great job!"]}function generateRecommendations(){const e=[],t={"<50k":"50/100/50","50k-100k":"100/300/100","100k-250k":"100/300/100","250k-500k":"250/500/250","500k-1m":"250/500/250 plus $1M umbrella","1m+":"500/500/500 plus $2M+ umbrella"}[formData.netWorth];e.push(`Based on your assets, we recommend ${t} liability coverage`),"250"!==formData.deductible&&"500"!==formData.deductible||e.push("Consider raising your deductible to $1,000 to save on premiums"),formData.hasUninsured||e.push("Add uninsured/underinsured motorist coverage matching your liability limits");return(new Date).getFullYear()-parseInt(formData.vehicleYear)>10&&(formData.hasCollision||formData.hasComprehensive)&&e.push("Consider dropping collision/comprehensive on older vehicles to save money"),e}function identifySavings(){const e=[];return e.push("Bundle auto with home insurance for up to 25% discount"),formData.cleanRecord&&e.push("Your clean driving record qualifies you for safe driver discounts"),"<5000"!==formData.annualMileage&&"5000-10000"!==formData.annualMileage||e.push("Low mileage discount available for driving less than 10,000 miles/year"),e.push("Pay-in-full discount can save 5-10% vs monthly payments"),e.push("Defensive driving course completion can save 5-15%"),"250"!==formData.deductible&&"500"!==formData.deductible||e.push("Raising deductible from $500 to $1,000 could save $200-400/year"),e}function showResults(){document.getElementById("autoCheckupForm").style.display="none",document.getElementById("resultsSection").style.display="block",window.scrollTo({top:0,behavior:"smooth"})}function startOver(){currentStep=1,formData={},document.getElementById("autoCheckupForm").reset(),document.getElementById("autoCheckupForm").style.display="block",document.getElementById("resultsSection").style.display="none",showStep(1),updateProgressBar()}function downloadReport(){const e=document.getElementById("scoreNumber").textContent,t=Array.from(document.querySelectorAll("#coverageGaps li")).map(e=>e.textContent),o=Array.from(document.querySelectorAll("#recommendations li")).map(e=>e.textContent),n=Array.from(document.querySelectorAll("#savingsOpportunities li")).map(e=>e.textContent),a=`\nAUTO COVERAGE CHECKUP REPORT\nGenerated: ${(new Date).toLocaleDateString()}\nBill Layne Insurance - (336) 835-1993\n\nCOVERAGE SCORE: ${e}/100\n\nCOVERAGE GAPS IDENTIFIED:\n${t.map(e=>`• ${e}`).join("\n")}\n\nOUR RECOMMENDATIONS:\n${o.map(e=>`• ${e}`).join("\n")}\n\nPOTENTIAL SAVINGS:\n${n.map(e=>`• ${e}`).join("\n")}\n\nNEXT STEPS:\n1. Call Bill Layne Insurance at (336) 835-1993 for a personalized quote\n2. Review your current policy documents\n3. Consider the recommended coverage changes\n4. Ask about available discounts\n\nThis report is for informational purposes only and does not constitute insurance advice.\nPlease consult with a licensed insurance professional for personalized recommendations.\n    `,r=new Blob([a],{type:"text/plain"}),i=window.URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=`auto-coverage-report-${(new Date).toISOString().split("T")[0]}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(i)}document.addEventListener("DOMContentLoaded",function(){populateYearDropdown(),setupFormValidation(),updateProgressBar()});const style=document.createElement("style");style.textContent="\n    input.error, select.error {\n        border-color: #E74C3C !important;\n    }\n",document.head.appendChild(style);